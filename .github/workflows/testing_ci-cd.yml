name: testing the first ci-cd setup

on:
  push:
    branches:
      - development

jobs:
  build:                                        # we can give the any name for jobs ex: build, dev-deploy
    name: initial build
    runs-on:  self-hosted                      # runner name

  strategy:
    matrix:
      python-version:["pypy3.10", "3.9", "3.10", "3.11", "3.12"]    # this whole block is used to which version it support

  steps:
    - uses: actions/checkout@v5                  # it checkouts default main to given branch  main --> development

    - name: use python ${{matrix.python-version}}
      uses: actions/setup-python@v5
      with:
        python-version:${{matrix.python-version}}

    - name: Display pyhton version
      run: python -c "import sys; print(sys.version)"

    - name: Activate vertual enviroment
      run: source py-venv/bin/activate
           
    - name:  Install dependencies
      run: |
          cd ci-cd-test
          pwd
          sudo git branch
          python -m pip install --upgrade pip
          python -m pip install -r requirement.txt
          echo "Dependencies installed Successfully"




  dev_deploy:
    name: Deploying to development server
    run-on: self-hosted
    needs: build

    steps:
      - name: checkout repository
        uses: action/checkout@v5
      
      - name: deploy
        run: |
         cd ci-cd-test
         pwd
         git pull origin development
         echo "Deployment completed"
    



